rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Products can be read by anyone, but only written by an admin
    match /products/{productId} {
      allow read: if true;
      // You must be an admin to create, update, or delete products.
      allow write: if request.auth != null && request.auth.token.email == "temahfingerofgod@gmail.com";
    }

    // Users can only manage their own user document.
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // Orders can be managed by any authenticated user.
    // The logic in the app's queries ensures users only see their own orders,
    // and admins can see all orders.
    match /orders/{orderId} {
      allow read, write, create, list: if request.auth != null;
    }

    // Site settings can be read by anyone, but only written by an admin.
    match /site/settings {
        allow read: if true;
        allow write: if request.auth != null && request.auth.token.email == "temahfingerofgod@gmail.com";
    }

    // Default deny all other collections to ensure security.
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
